<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>hackaton ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <nav class="navbar">
    <a href="{{ url_for('index.index_page') }}" class="brand">Legacy‚Ñ¢</a>
    <div class="nav-links">
      <a href="{{ url_for('index.index_page') }}">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="{{ url_for('search.search_page') }}">–ü–æ–∏—Å–∫</a>
    </div>
  </nav>

  <div class="container">
    <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</h1>
    {% if xml_filename %}
    <div class="download-btn-container" style="margin-bottom:20px;">
      <a href="{{ url_for('result.download_xml', filename=xml_filename) }}" class="btn" download>üì• –°–∫–∞—á–∞—Ç—å XML</a>
    </div>
    {% endif %}
    {% if results %}
      {% for result in results %}
        <div class="result-card">
          <div class="card">
            <a href="{{ url_for('result.result_page', id=result.id) }}">
              <img src="{{ url_for('static', filename='processed/' + result.processed_image) }}"
                   alt="–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ {{ result.original_filename }}"
                   class="thumbnail">
            </a>
          </div>
          <div class="download-btn-container">
            <a href="{{ url_for('static', filename='processed/' + result.processed_image) }}"
               class="btn" download>üì• –°–∫–∞—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</a>
          </div>
          <div class="card-info">
            <p>{{ result.original_filename }}</p>
          </div>
          <div class="result-details">
            {% if result.objects_translated %}
              <h3>–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:</h3>
              <ul>
                {% for obj in result.objects_translated %}
                  <li>{{ obj }}</li>
                {% endfor %}
              </ul>
            {% else %}
              <p><em>–ù–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.</em></p>
            {% endif %}
            {% if result.text %}
              <h3>–†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</h3>
              <pre style="white-space: pre-wrap;">{{ result.text }}</pre>
            {% else %}
              <p><em>–¢–µ–∫—Å—Ç –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω.</em></p>
            {% endif %}
            {% if result.corrected_text %}
              <h3>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</h3>
              <p>{{ result.corrected_text }}</p>
            {% else %}
              <p><em>–ù–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.</em></p>
            {% endif %}
            {% if result.translated_text %}
              <h3>–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π:</h3>
              <p>{{ result.translated_text }}</p>
            {% else %}
              <p><em>–ù–µ—Ç –ø–µ—Ä–µ–≤–æ–¥–∞.</em></p>
            {% endif %}
          </div>
        </div>
        <hr>
      {% endfor %}
    {% else %}
      <p>–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏.</p>
    {% endif %}
    <p><a href="{{ url_for('index.index_page') }}" class="btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
  </div>

  <div id="imageModal" class="modal">
    <span class="close-btn">&times;</span>
    <img class="modal-content" id="modalImg" alt="–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
    <div id="modalCaption"></div>
  </div>

  <script>
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImg');
    const captionText = document.getElementById('modalCaption');
    const closeBtn = document.querySelector('.close-btn');

    document.querySelectorAll('.thumbnail').forEach(img => {
      img.addEventListener('click', () => {
        modal.style.display = 'block';
        modalImg.src = img.src;
        captionText.textContent = img.alt;
      });
    });

    closeBtn.onclick = () => {
      modal.style.display = 'none';
    };
  </script>
</body>
</html>
